language: python
python:
  - "3.9"

services:
  - docker

addons:
  sonarcloud:
    organization: "thecodingkittens" # the key of the org you chose at step #3

before_install:
  - docker build -t image .
  - docker run -d -p 8000:8000 --name travis image

script:
  - docker exec -i travis pytest --cov=app
  - docker exec -e TRAVIS_JOB_ID="$TRAVIS_JOB_ID" -e TRAVIS_BRANCH="$TRAVIS_BRANCH"
  - sonar-scanner

  after_success:
  - coveralls
